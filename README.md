# FaceID - Система распознавания лиц на Flask

Веб-приложение для распознавания лиц, построенное на Flask и OpenCV.

## 🚀 Возможности

- **Сбор данных лиц** - Веб-интерфейс для сбора изображений лиц
- **Обучение модели** - Автоматическое обучение модели распознавания
- **Распознавание в реальном времени** - Видео поток с распознаванием лиц
- **Загрузка изображений** - Распознавание лиц на загруженных фотографиях
- **Настройка параметров** - Регулировка порога уверенности
- **Тестирование точности** - Проверка качества обученной модели

## 📋 Требования

- Python 3.10+
- OpenCV 4.x
- Flask 3.x
- NumPy
- dlib 19.x
- Веб-камера (для сбора данных и распознавания в реальном времени)

## 🛠 Установка

1. **Клонируйте репозиторий:**
```bash
git clone https://github.com/PlagueEvgeny/FaceID.git
cd FaceID
```

2. **Создайте виртуальное окружение:**
```bash
python -m venv venv
source venv/bin/activate  # Linux/Mac
# или
venv\Scripts\activate     # Windows
```

3. **Установите зависимости:**
```bash
pip install -r requirements.txt
```

4. **Запустите приложение:**
```bash
python -m app.app
```

5. **Откройте браузер:**
```
http://127.0.0.1:5000
```

## 📁 Структура проекта

```
├── 📁 app
│   ├── 📁 api
│   │   ├── 📄 __init__.py
│   │   ├── 📄 recognition_api.py
│   │   └── 📄 system_api.py
│   ├── 📁 services
│   │   ├── 📄 __init__.py
│   │   ├── 📄 face_recognizer.py
│   │   ├── 📄 frame_generator.py
│   │   ├── 📄 init_system.py
│   │   └── 📄 models.py
│   ├── 📁 static
│   │   ├── 📁 css
│   │   │   └── 📄 style.css
│   │   ├── 📁 images
│   │   ├── 📁 js
│   │   │   └── 📄 main.js
│   │   └── 📁 uploads
│   ├── 📁 templates
│   │   ├── 📄 base.html
│   │   ├── 📄 collect_data.html
│   │   ├── 📄 index.html
│   │   └── 📄 recognize.html
│   ├── 📁 utils
│   │   ├── 📄 __init__.py
│   │   ├── 📄 download_cascade.py
│   │   ├── 📄 logs.py
│   │   └── 📄 transliterate.py
│   ├── 📄 __init__.py
│   ├── 📄 app.py
│   ├── 📄 config.py
│   └── 📄 router.py
├── 📁 logs
│   └── 📄 activity.json
├── 📄 .gitignore
├── 📄 LICENSE
├── 📄 README.md
└── 📄 requirements.txt
```

## 🎯 Использование

### 1. Сбор данных лиц

1. Перейдите на страницу "Сбор данных"
2. Введите имя человека
3. Нажмите "Начать сбор"
4. Смотрите в камеру, поворачивайте голову в разные стороны
5. Система автоматически соберет 100 изображений
6. Нажмите "Обучить модель" после завершения сбора

### 2. Распознавание лиц

1. Перейдите на страницу "Распознавание"
2. Используйте видео поток для распознавания в реальном времени
3. Или загрузите изображение для анализа
4. Настройте порог уверенности при необходимости

### 3. Тестирование модели

1. На странице распознавания нажмите "Тест точности"
2. Система проверит качество распознавания на тестовых данных
3. Получите отчет о точности для каждого человека

## ⚙️ Настройки

### Переменные окружения

- `DEFAULT_HOST` - IP адрес сервера (по умолчанию: 0.0.0.0)
- `DEFAULT_PORT` - Порт сервера (по умолчанию: 5000)
- `DEBUG_MODE` - Режим отладки (по умолчанию: True)

### Параметры распознавания

- **Порог уверенности** - Чем меньше значение, тем строже распознавание
- **Размер изображения** - 130x100 пикселей (оптимально для LBPH)
- **Количество изображений** - 200 на человека (рекомендуется)

## 🔧 API Endpoints

### Основные endpoints

- `GET /` - Главная страница
- `GET /collect_data` - Страница сбора данных
- `GET /recognize` - Страница распознавания
- `GET /video_feed` - Видео поток
- `GET /get_status` - Статус системы

### API endpoints

- `POST /api/train_model` - Обучить модель
- `GET /api/model_info` - Информация о модели
- `POST /api/recognize_image` - Распознать лица на изображении
- `POST /api/update_threshold` - Обновить порог уверенности
- `POST /api/test_accuracy` - Тест точности модели

## 🐛 Устранение неполадок

### Камера не работает

1. Проверьте подключение веб-камеры
2. Убедитесь, что камера не используется другим приложением
3. Проверьте разрешения браузера на доступ к камере

### Ошибки распознавания

1. Убедитесь, что модель обучена
2. Проверьте качество освещения
3. Попробуйте изменить порог уверенности

### Низкая точность

1. Соберите больше разнообразных изображений
2. Обеспечьте хорошее освещение при сборе данных
3. Включите изображения с разными выражениями лица

## 📝 Логирование

Приложение ведет логи активности в файле `activity.json`.

## 📄 Лицензия

GPL-3.0 license - см. файл LICENSE для деталей.
